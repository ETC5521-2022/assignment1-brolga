---
title: "ETC5521 Assignment 2"
subtitle: "Board Games analysis"
team: Brolga
author:
  - [Dhruv Nirmal]
  - [Gui Gao]
  - [Krisanat Anukarnsakulchularp]
  - [Alison Phan]
date: "`r Sys.Date()`"
output: 
  bookdown::html_document2: default
keep_md: true
---


[This assignment is for ETC5521 Assignment 1 by Team `r rmarkdown::metadata$team` comprising of `r knitr::combine_words(rmarkdown::metadata$author)`.]{style="color:#006DAE;"}


```{r setup, include = TRUE, echo = FALSE}
knitr::opts_chunk$set(
  echo = FALSE,
  eval = TRUE,
  message = FALSE,
  warning = FALSE,
  fig.width = 8,
  fig.height = 6,
  fig.pos = "H"
)
```


```{r}
# library packages
library(dplyr)
library(tidyr)
library(ggplot2)
library(stringi)
library(stringr)
library(ggpubr)
library(factoextra)
library(broom)
library(tibble)
library(purrr)
theme_set(theme_minimal())


# read data
ratings <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-01-25/ratings.csv')
details <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-01-25/details.csv')
```

# Introduction and motivation

This paper seeks to explore the evolution of the game’s popularity. We will be using two datasets on games from R for Data Science/ tidytuesday which is a weekly data project in R from Kaggle’s Board Games Geek that is contributed by David Baranger and Georgios Karamanis. A game is often played as a social form of entertainment. Gaming is considered the world’s favourite form of entertainment where the gaming industry has generated more revenue than TV, movies, and music (OppenheimerFunds, 2018).  Not only do they transport us to new realities to satisfy our needs for recognition and achievements, but they also keep us interested and engaged due to their attention to detail (Barone, 2022). Over the years as the gaming industry is booming (Read, 2022), it is essential for gaming developers to target and identify factors that would satisfy and attract customers to buy their games. Today, with many games on the market, it has been increasingly difficult and competitive among companies as they face a new generation of buyers with different needs (Prystupa-Rządca & Starostka, 2022). As it is essential to stay on top of the latest insights from around the globe, we are motivated to investigate the factors that influence buyers’ behaviour regarding their gaming preferences and purchases to assist companies in improving their future game products and profitability. We aim to understand factors that affect and influences buyers psychologically.


# Data description



# Questions of interest

## Questions list

Q1.
How board game ratings change by year of publication?

Q2.
Trends in game mechanics over time.

Q3.
Trends in board game publication rates over time.

Q4.
What are the common game mechanics and their changes in prevalent?

Q5.
What types of games are becoming increasingly popular?

Q6.
How many games have each listed how many mechanics?

Q7.
What is the distribution of ratings for the board games?

Q8.
Is there a linear relationship between the year of release of a game and the average rating it receives?

Q9.
Are Board Game Descriptions more positive or negative?

Q10.
What are the 10 most common words used in board game descriptions?

Q11. 
Is there any relationship between average game time and ownership, min/max 
players?

Q12. 
How does number of people who wish to own the game and who own the game plot 
against each other?  

Q13. 
How does Rank and average rating plot against each other. (Highly ranked games should have more rating)

Q14. 
Which age group prefers which type of game eg medical , building etc.? eg. 
younger children might be interested in building games etc and teenagers might be 
interested in games like Monopoly

Q15. 
Are people intrigued by a particular game designer?

Q16. 
How did the era of electronic games(starting from 2010-11) affect the number of people who want/wish/own board games?

Q17. 
Is it right to assume that a game board publisher publishes a single type of 
board game and do the game publishers only focus on a certain age group?

Q18. 
Are people intrigued by a particular game publisher?

Q19. 
How accurate has bayes average been?

Q20. 
Which era or decade played a big role in people playing more board games?

**Q21. Games developed in the earlier years are more in demand despite their low ratings, people still collect it rather than play. Game artworks may influence people’s wishes to own the game despite the game being uninteresting to play.  Is this statement true and why is it the case?**

**Q22.The higher the ratios of people who wish to the own game and those who own the game could indicate the popularity of the game regardless of the minimum age, duration of the games, years publication and the game characteristics. Explore the factors that influence the ownership of the games.**

**Q23.


**Q24.






## Interested Questions

Q1. Games developed in the earlier years are more in demand despite their low ratings, people still collect it rather than play. Game artworks may influence people’s wishes to own the game despite the game being uninteresting to play.  Is this statement true and why is it the case?

Q2.The higher the ratios of people who wish to the own game and those who own the game could indicate the popularity of the game regardless of the minimum age, duration of the games, years publication and the game characteristics. Explore the factors that influence the ownership of the games.

Q3.


Q4.



# Expected findings

**Q1. Games developed in the earlier years are more in demand despite their low ratings, people still collect it rather than play. Game artworks may influence people’s wishes to own the game despite the game being uninteresting to play.  Is this statement true and why is it the case?**

The statement “Games developed in the earlier years are more in demand despite their low ratings, people still collect it rather than play” may be true as consumers tend to buy fewer games compared to past decades, however, they are spending more time with those games indicating that games were more in higher demand back in the days (Brambilla Hall, 2022). The other statement “Game artworks may influence people’s wishes to own the game despite the game being uninteresting to play”, may be true as colour and lines have been known to create human wants and desire (Zeller, 2022).

**Q2. The higher the ratios of people who wish to the own game and those who own the game could indicate the popularity of the game regardless of the minimum age, duration of the games, years publication and the game characteristics. Explore the factors that influence the ownership of the games.**

Studies have shown that games exploded in popularity when consumers tried to keep themselves entertained while being forced to stay at home (Epstein, 2022). As games are often considered a form of entertainment and an escape from boredom, during periods such as Covid-19 during lockdowns, there would be an increase in game ownership.

**Q3.

**Q4.

# Analysis and findings

**Q1. Games developed in the earlier years are more in demand despite their low ratings, people still collect it rather than play. Game artworks may influence people’s wishes to own the game despite the game being uninteresting to play.  Are these statements true and why is it the case?**

Pre-processing step:
```{r}
detailsv2=details %>% filter(yearpublished!=0)

## create additional column that is based on world event (source: https://www.usatoday.com/story/money/2020/09/06/the-worlds-most-important-event-every-year-since-1920/113604790/)


detailsv2 = detailsv2 %>% mutate(world_year = case_when(
  (yearpublished <1914)~ "1. Before First World War",
  (yearpublished >= 1914) & (yearpublished <1919)~ "2. During First World War",
  (yearpublished >= 1919) & (yearpublished <1939)~ "3. Before Second World War",
  (yearpublished >= 1939) & (yearpublished <1946)~ "4. During Second World War",
  (yearpublished >= 1946) & (yearpublished <1965)~ "5. Baby Boomer",
  (yearpublished >= 1965) & (yearpublished <1983)~ "6. Before Internet",
  (yearpublished >= 1983) & (yearpublished <1993)~ "7. Internet Born",
  (yearpublished >= 1993) & (yearpublished <2008)~ "8. Amazon, Google and Touchscreen Mobile Born",
  (yearpublished >= 2008) & (yearpublished <2009)~ "9. Global Financial Crisis",
  (yearpublished >= 2009) & (yearpublished <2020)~ "10. Post Global Financial Crisis",
  (yearpublished >= 2020) & (yearpublished <2022)~ "11. During COVID",
  (yearpublished >= 2022) ~ "12. Post COVID",
  
))

detailsv2$world_year = as.factor(detailsv2$world_year)

levels(detailsv2$world_year) =  c("1. Before First World War",
                                     "2. During First World War",
                                     "3. Before Second World War",
                                     "4. During Second World War",
                                     "5. Baby Boomer",
                                     "6. Before Internet",
                                     "7. Internet Born",
                                     "8. Amazon, Google and Touchscreen Mobile Born",
                                     "9. Global Financial Crisis",
                                     "10. Post Global Financial Crisis",
                                     "11. During COVID",
                                     "12. Post COVID")
```


```{r echo=FALSE}
#### Part 1. Games developed in the earlier years are more in demand despite their low ratings, people still collect it rather than play. 

d1 = detailsv2 %>% select(id, yearpublished, owned, trading, wanting, wishing, world_year)
d2 = ratings %>% select(id, bayes_average)
q1 = merge(d1, d2, by="id") ## joined data for analysis later


summary(q1$yearpublished)
q1 %>% group_by(world_year) %>% tally()

q1 %>% 
  filter((yearpublished>=1914) & (yearpublished <2023)) %>%
ggplot( aes(bayes_average)) +
  geom_histogram(alpha = 0.8)

q1 %>% 
  group_by(yearpublished) %>%
  
  filter((yearpublished>=1914) & (yearpublished <2023)) %>%
  
  summarise(mean_bayes_average = mean(bayes_average)) %>%

  ggplot(aes(x=yearpublished , y=mean_bayes_average)) + 
  geom_point() + 
  geom_line() + 
  geom_smooth() +
  labs(title = "Yearly mean_bayes_average",
       y = "Yearly mean_bayes_average",
       x = "Year") 


q1 %>%
  ggplot(aes(x=wanting , y= wishing )) + 
  geom_point() 


q1 %>% # select(-bayes_average) %>% 
  filter((yearpublished>=1914) & (yearpublished <2022)) %>%
  group_by(id) %>%
  mutate( wanting_wishing = wanting + wishing,
          rating = ifelse(bayes_average < mean(ratings$bayes_average), "Below Average", "Above Average")) %>%
  select(-c("wishing", "wanting","bayes_average")) %>%
  gather(key,value,-c(id,yearpublished,world_year,rating))%>%
  arrange(id) %>%
 mutate(percent = prop.table(value)) %>%
  ggplot(aes(x=yearpublished, y =percent)) + geom_jitter(alpha = 0.01) + 
  geom_smooth() + facet_grid(key ~ rating) + theme_bw()


q1 %>% # select(-bayes_average) %>% 
  filter((yearpublished>=2000) & (yearpublished <2022)) %>%
  group_by(id) %>%
  mutate( wanting_wishing = wanting + wishing,
          rating = ifelse(bayes_average < mean(ratings$bayes_average), "Below Average", "Above Average")) %>%
  select(-c("wishing", "wanting","bayes_average")) %>%
  gather(key,value,-c(id,yearpublished,world_year,rating))%>%
  arrange(id) %>%
  mutate(percent = prop.table(value)) %>%
  ggplot(aes(x=yearpublished, y =percent)) + geom_jitter(alpha = 0.01) + 
  geom_smooth() + facet_grid(key ~ rating) + theme_bw()



##### Part2.  Game artworks may influence people’s wishes to own the game despite the game being uninteresting to play.  


d1 = detailsv2 %>% select(id, yearpublished, owned, trading, wanting, wishing, boardgameartist, boardgamedesigner)
d2 = ratings %>% select(id, bayes_average,rank)
q1 = merge(d1, d2, by="id") ## joined data for analysis later

q2 = q1 %>%
  mutate(boardgameartist = stri_replace_all_regex(boardgameartist,
                             pattern=c('\\[', '\\]', "\\'",'\\"', '\\\\'),
                             replacement=c('', '', '','',''),
                             vectorize=FALSE))
q2$cnt<-unlist(lapply(str_split(q2$boardgameartist, ","), length))

#  filter to select only those games that have single artist
single_artist <- q2 %>% 
  filter(cnt==1)

glimpse(unique(single_artist$boardgameartist))


top_boardgameartist <-single_artist %>% 
  filter((!is.na(boardgameartist) ), (boardgameartist != "(Uncredited)")) %>% 
  group_by(boardgameartist) %>% 
  tally() %>% 
  top_n(70, n) %>% 
  arrange(desc(n))

top_boardgameartist

games_df<- q2 %>% filter(boardgameartist %in% top_boardgameartist$boardgameartist)
games_df2 = games_df %>% group_by(boardgameartist) %>%
  summarise(mean_owned=mean(owned),
            mean_bayes_average=mean(bayes_average )) 
games_df2 %>%
  ggplot(aes(x=mean_owned,y=mean_bayes_average,label=boardgameartist)) + geom_point() + geom_text() + theme_bw()


set.seed(123)
res.km <- kmeans(scale(games_df2[,-1]),3 , nstart = 25)
# Dimension reduction using PCA
res.pca <- prcomp(games_df2[, -1],  scale = TRUE)
# Coordinates of individuals
ind.coord <- as.data.frame(get_pca_ind(res.pca)$coord)
# Add clusters obtained using the K-means algorithm
ind.coord$cluster <- factor(res.km$cluster)
# Add Species groups from the original data set
ind.coord$boardgameartist <- games_df2$boardgameartist
# Data inspection
head(ind.coord)

# Percentage of variance explained by dimensions
eigenvalue <- round(get_eigenvalue(res.pca), 1)
variance.percent <- eigenvalue$variance.percent
head(eigenvalue)

ggscatter(
  ind.coord, x = "Dim.1", y = "Dim.2", 
  color = "cluster", palette = "npg", ellipse = TRUE, ellipse.type = "convex",
  label = "boardgameartist", size = 1.5,  legend = "right", ggtheme = theme_bw(),
  xlab = paste0("Dim 1 (", variance.percent[1], "% )" ),
  ylab = paste0("Dim 2 (", variance.percent[2], "% )" )
) +
  stat_mean(aes(color = cluster), size = 4)

```
```


# Pre-processing step
- created an additional column that is based on world event (source: https://www.usatoday.com/story/money/2020/09/06/the-worlds-most-important-event-every-year-since-1920/113604790/)
- joined ratings and details together using 'id' as mapping key 
- excluded years with limited data availability

Due to the limited data availability, we will only be focusing from 1914 (start of World War I) to 2022.  By using the bayes average for the trend for rating, we can see that the fluctuation has decreased significantly. We can also see that “wanting” and “wishing” are positively correlated. By combining “wanting” and “wishing” together, would we be able to have a representation of the games that are in demand. Ratings that are below average 5.68 based on bayes mean is considered as a low rating game.  Despite low ratings, there is only a slight decrease in games that are owned in recent years, especially after Global Financial Crisis where it has reflected higher in demand. Games that were published earlier had slightly lower ratings however they were not in high demand. This means that our first statement where “games developed in the earlier years are more in demand despite their low ratings, people still collect it rather than play” is incorrect.

For this analysis, we will be focusing only the top 70 games with a single artist. Based on the plot for “average own” and “bayes average”, we can see that games from Chris Quilliams and Miguel Coimbra have high number of owned and ratings that are higher than 6. Interestingly, although the ratings for Cyril Bouquet is below 6, the games owned is more than 6000. This could indicate that the artwork is attractive, and people own it as a collection even though it might not be interesting to play. When doing clustering analysis, we also see that the artist can be grouped into 3 clusters. With the cluster 1 (red), being high quality artwork and can be kept as collection. This means that our second statement were “Game artworks may influence people’s wishes to own the game despite the game being uninteresting to play” is true. 


**Q2.  The higher the ratios of people who wish to the own game and those who own the game could indicate the popularity of the game regardless of the minimum age, duration of the games, years publication and the game characteristics. Explore the factors that influence the ownership of the games?**

```{r echo=FALSE}

d1 = detailsv2 %>% mutate( popularity=  (wanting+wishing) / owned )
d2 = ratings %>% select(id, bayes_average)
q1 = merge(d1, d2, by="id") ## joined data for analysis later

summary(q1$popularity)
q1 %>% filter(popularity > 1)
q1 %>% 
  ggplot(aes(x=bayes_average, y = popularity))+ geom_point() + facet_wrap(world_year~. )  


q1 %>% 
  filter(world_year != "4. During Second World War") %>%
  ggplot(aes(x=bayes_average, y = popularity))+ geom_point() + facet_wrap(world_year~. )  



  
q2 = q1 %>%
  mutate(boardgamecategory = stri_replace_all_regex(boardgamecategory,
                             pattern=c('\\[', '\\]', "\\'",'\\"', '\\\\'),
                             replacement=c('', '', '','',''),
                             vectorize=FALSE))
q2$cnt<-unlist(lapply(str_split(q2$boardgamecategory, ","), length))

single_cat<-q2 %>% 
  filter(cnt==1)

top_10 = single_cat  %>% 
  filter(!is.na(boardgamecategory)) %>% 
  group_by(boardgamecategory) %>% 
  tally() %>% 
 top_n(10, n) 

q2 = single_cat %>% 
  filter(boardgamecategory %in% top_10$boardgamecategory) 

q2 %>% 
  group_by(boardgamecategory,world_year) %>% 
  tally() %>% 
 # top_n(30, n) %>% 
  arrange(desc(n)) %>%
  ggplot(aes(x= reorder(boardgamecategory, n), y=n)) + 
  geom_bar(stat="identity", fill="#f68060", alpha=.6, width=.4) +
    coord_flip() +
    xlab("") +
    theme_bw() +  facet_wrap(world_year~. ) 



q2 %>% 
  filter(! world_year %in%   c("4. During Second World War", "5. Baby Boomer", "6. Before Internet", "5. Baby Boomer")) %>%
  group_by(world_year) %>% 
  summarize(t_test = list(t.test(popularity))) %>% 
  mutate(tidied = map(t_test, broom::tidy)) %>%
  unnest(tidied) %>% 
  ggplot() + 
  geom_errorbarh(aes(xmin = conf.low,
                    xmax = conf.high,
                    y = world_year))



reg = q2 %>%
  filter(! world_year %in%   c("4. During Second World War", "5. Baby Boomer", "6. Before Internet", "5. Baby Boomer")) %>%
  group_by(world_year, boardgamecategory) %>%
  nest() %>% 
  mutate(
    fit = map(data, ~ lm(popularity ~ trading+bayes_average+ minplayers + maxplayers + playingtime+ minplaytime + maxplaytime + minage , data = .x)),
    tidied = map(fit, tidy),
    glanced = map(fit, glance),
    augmented = map(fit, augment)) %>%
  mutate(
    rsq = glanced %>% map_dbl("r.squared"),
  ) 




reg %>% 
  unnest(tidied) %>% 
  select(world_year,boardgamecategory, term, estimate, rsq) %>% 
  spread(term, estimate) %>% 
  ggplot(aes(`(Intercept)`, minage)) +
  geom_point(aes(colour = world_year, size = rsq)) +
  geom_smooth(se = FALSE) +
  scale_size_area() +
  theme_minimal()



reg %>% 
  unnest(tidied) %>% 
  select(world_year,boardgamecategory, term, estimate, rsq) %>% 
  spread(term, estimate) %>% 
  ggplot(aes(`(Intercept)`, playingtime)) +
  geom_point(aes(colour = world_year, size = rsq)) +
  geom_smooth(se = FALSE) +
  scale_size_area() +
  theme_minimal()



reg %>% 
  unnest(tidied) %>% 
  select(world_year,boardgamecategory, term, estimate, rsq) %>% 
  spread(term, estimate) %>% 
  ggplot(aes(`(Intercept)`, maxplayers)) +
  geom_point(aes(colour = world_year, size = rsq)) +
  geom_smooth(se = FALSE) +
  scale_size_area() +
  theme_minimal()





## residual
reg %>% 
  unnest(augmented) %>% 
  ggplot(aes(bayes_average, .resid)) +
  geom_line(aes(group = boardgamecategory), alpha = 0.3) +
  geom_hline(yintercept = 0, colour = "red", size = 1) +
  geom_smooth(se = FALSE, size = 1.5) +
  facet_wrap( ~ world_year) +
  theme_minimal()





```

For this analysis, we have defined popularity by summing the “wanting” and “wishing” and then dividing it by the “owned” to get an indication of the board game popularity. Games during World War II is excluded in our analysis as they are outliers. Based on our observation, interestingly during World War I, before World War II and during Covid-19, board games have gained popularity. Limit to single category game type, card game and abstract strategy are the top two most popular game categories. Intriguingly, during the global financial crisis and post-global financial crisis, abstract strategy type game is more popular compared to the card game, even though card game is usually the most popular regardless of the period.  

Due to the limited data in certain periods, we have removed games published in periods during World War II, Baby Boomer and Before the Internet when performing a one-sided t-test to understand if the popularity is statistically significant. The result showed that all periods are significant, except the period when the Internet was born.

Multiple linear regressions were fitted to the data for different periods. Based on the residuals, the models did not fit well with the games published during World War I, before World War II and during Covid-19. This suggests that when the world is not at peace, the board game's popularity could fluctuate a lot. “Playing time” and “maxplayers” both seem to be important factors that have contributed to the game’s popularity in recent few years (i.e. Post Covid-19). In contrast, “minage” does not seem to be relevant to popularity.


## Data limitations:

* Missing information, so we needed to remove it.
* Insufficient data so we removed it to avoid misleading information.







# Conclusion



# References

Alboukadel Kassambara (2020). ggpubr: 'ggplot2' Based Publication Ready Plots. R package version 0.4.0. https://CRAN.R-project.org/package=ggpubr

Alboukadel Kassambara and Fabian Mundt (2020). factoextra: Extract and Visualize the Results of Multivariate Data Analyses. R package version 1.0.7. https://CRAN.R-project.org/package=factoextra

Barone, R. (2022). Video games are fun. Here's why, and how they hook us. https://www.idtech.com/blog/what-makes-video-games-fun#:~:text=Why%20are%20video%20games%20fun,to%20their%20attention%20to%20detail.

Brambilla Hall, S. (2022). COVID-19 is taking gaming and esports to the next level. World Economic Forum. https://www.weforum.org/agenda/2020/05/covid-19-taking-gaming-and-esports-next-level/.

David Robinson, Alex Hayes and Simon Couch (2022). broom: Convert Statistical Objects into Tidy Tibbles. R package version 0.7.12. https://CRAN.R-project.org/package=broom

Epstein, A. (2022). Game on: How COVID-19 became the perfect match for gamers. World Economic Forum. https://www.weforum.org/agenda/2020/09/covid19-coronavirus-pandemic-video-games-entertainment-media/.

Gagolewski M (2021). _stringi: Fast and portable character string processing in R_. R package version 1.7.6, <URL: https://stringi.gagolewski.com/>.

Gagolewski M (2021). “stringi: Fast and portable character string processing in R.” _Journal of Statistical Software_. to appear.

H. Wickham. ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York, 2016.

Hadley Wickham (2019). stringr: Simple, Consistent Wrappers for Common String Operations. R package version 1.4.0. https://CRAN.R-project.org/package=stringr

Hadley Wickham and Maximilian Girlich (2022). tidyr: Tidy Messy Data. R package version 1.2.0. https://CRAN.R-project.org/package=tidyr

Hadley Wickham, Romain François, Lionel Henry and Kirill Müller (2022). dplyr: A Grammar of Data Manipulation. R package version 1.0.8. https://CRAN.R-project.org/package=dplyr
https://www.weforum.org/agenda/2022/07/gaming-pandemic-lockdowns-pwc-growth/#:~:text=The%20video%20game%20sector%20is,exceed%20%24320%20billion%20by%202026.
https://zellerhausart.com/blog/how-artwork-influences-purchase-decisions.

Kirill Müller and Hadley Wickham (2021). tibble: Simple Data Frames. R package version 3.1.6. https://CRAN.R-project.org/package=tibble

Lionel Henry and Hadley Wickham (2020). purrr: Functional Programming Tools. R package version 0.3.4. https://CRAN.R-project.org/package=purrr

OppenheimerFunds (2018). Investing in the Soaring Popularity of Gaming. https://www.reuters.com/article/sponsored/popularity-of-gaming.

Prystupa-Rządca, K., & Starostka, J. (2022). Customer Involvement in the Game Development Process. https://jemi.edu.pl/vol-11-issue-3-2015/customer-involvement-in-the-game-development-process.

Read, S. (2022). Gaming is booming and is expected to keep growing.

Young, A., & Harrington, J. (2022). World history: These are among the most important global events to happen annually since 1920. https://www.usatoday.com/story/money/2020/09/06/the-worlds-most-important-event-every-year-since-1920/113604790/

Zeller, P. (2022). How Artwork Influences Purchase Decisions.









