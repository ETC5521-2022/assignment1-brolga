---
title: "ETC5521 Assignment 1"
subtitle: "Board Games analysis"
team: brolga
author:
  - [Dhruv Nirmal]
  - [Gui Gao]
date: "`r Sys.Date()`"
output: 
  bookdown::html_document2: default
keep_md: true
---


[This assignment is for ETC5521 Assignment 1 by Team `r rmarkdown::metadata$team` comprising of `r knitr::combine_words(rmarkdown::metadata$author)`.]{style="color:#006DAE;"}


```{r setup, include = TRUE, echo = FALSE}
knitr::opts_chunk$set(
  echo = FALSE,
  eval = TRUE,
  message = FALSE,
  warning = FALSE,
  fig.width = 8,
  fig.height = 6,
  fig.pos = "H"
)
```


```{r}
# library packages
library(tidyverse)
library(kableExtra)
library(knitr)
library(drlib)
library(tidyr)
library(ggplot2)
library(plotly)
library(performance)
library(stringr)
library(broom)
```


```{r}
# read data
ratings <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-01-25/ratings.csv')
details <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-01-25/details.csv')
```


# Introduction and motivation

## Introduction:

The classic Board Games have been around for decades, bringing people together to enjoy the traditional game. In Greece there are many popular board game associations and 'fan clubs' which organise many tournaments and offer a wealth of prizes. 

Today, although Computer Games are in a golden age of development with technological support, there are still many great board games that are released each year and attract a lot of attention.

**Board Game Geek** is a specialist board game website. Users can find every board game and information about it. This information includes descriptions of the games, reviews, user ratings, professional ratings, prices, where to buy and more.


## Motivation:

My teammates and I are both interested in board games and have tried many interesting board games. This study and analysis of the huge dataset of board games can help us understand board games from a different perspective, and also help us understand the whole landscape of board games and how it has changed over time.

So, we have tried to dig deeper into the data itself to show some reports and interesting data visualisations of the results.


## Data limitations:

* The original data contains about 15-19 million reviews, and the data in the dataset should be filtered to affect the results of analyzing whether the mean scores of the games conform to a normal distribution.

* There will be some irregularly recorded data inside the dataset, for example, there will be games with negative time years and 0 inside **yearpulished** varieble, which may bring limitations to our analysis.


# Data description

## Source of the data

Our data comes from *Kaggle* by way of **Board Games Geek**, with a hattip to *David and Georgios*. 
We could find the data via the following website:
https://github.com/rfordatascience/tidytuesday/tree/master/data/2022/2022-01-25


## The structure of the data

We have two initial datasets, **ratings** and **details**. The initial size of the ratings dataset is around 4.8MB and contains 21631 observations and 10 columns. The original size of the details dataset is approximately 32.7MB, with 21831 observations and 23 columns.

* About **ratings** dataset:
[This dataset](https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-01-25/ratings.csv) contains information about the average rating , rank and theoretical rating average (bayes average). Every game's url and thumbnail link is also provided. It was collected over a time period of 100 AD to 2022.


```{r}
# read ratings data structure csv
ratings_structure <- read_csv("ratings.csv")
```


```{r}
tibble(
  "variable" = c("id", "name", "average"),
  "class" = c("double", "character", "double"),
  "description" = c("Game ID", "Game name", "Average rating on Board Games Geek (1-10)")
) %>%
  kable() %>%
  kable_styling(full_width = F,
                bootstrap_options = c("striped", "condensed", "bordered"))
```

* About **details** dataset observations:
[The details](https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-01-25/details.csv) dataset provides information about the type of board game, game mechanics, who was the artist, creator and publisher of the game. It provides an extensive detail about the game such as min and max player who can play the game, minimum age, how the game is played and also put each game in categories such as building, dice, drinking e.t.c. The data collected is over a time period of 400 
AD to 2023.


```{r}
# read details data structure csv
details_structure <- read_csv("details.csv")
```


```{r}
tibble(
  "variable" = c("id", "yearpublished", "minplayers", "maxplayers", "playingtime", 
                  "boardgamemechanic", "owned", "trading", "wanting", "wishing"),
  "class" = c("double", "double", "double", "double", "double", 
              "character", "double", "double", "double", "double"),
  "dsecription" = c("Game ID", 
                    "Year game was published", 
                    "Game mechanic - how to play the game (separated by comma)",
                    "Minimum number of players required to play",
                    "Maximum number of players required to play",
                    "Average playing time of a game",
                    "People who own a game",
                    "People who trade a game",
                    "People who want to own a game",
                    "People who wish to own a game")
) %>%
  kable() %>%
  kable_styling(full_width = F,
                bootstrap_options = c("striped", "condensed", "bordered"))
```


## Data Wrangling

* filter rows: We have about 30 non-repeating variables in our datasets, so we use the **select** function to filter out the variables we want to use before analyzing the questions

* join: Our data comes from two datasets, but they have some same variables, so we use the **join** function to merge them together for analysis

* separate rows: A board game may have multiple game mechanics, and I use **separate_rows** function that splits each game mechanic by comma and then calculates

* remove NA rows: Among the variables we select, there are some **NA** values that affect our plotting results, therefore, I use **na.omit** function to delete NA rows

* remove special characters: I split the game mechanics, but there arre special symbols inside the strings, so I use **gsub** function to delete all the special symbols


# Questions of interest

## Questions list

Q1.
How board game ratings change by year of publication?

Q2.
Trends in game mechanics over time.

Q3.
Trends in board game publication rates over time.

Q4.
**What are the common game mechanics and their changes in prevalent?**

Q5.
What types of games are becoming increasingly popular?

Q6.
How many games have each listed how many mechanics?

Q7.
**What is the distribution of ratings for the board games?**

Q8.
Is there a linear relationship between the year of release of a game and the average rating it receives?

Q9.
Are Board Game Descriptions more positive or negative?

Q10.
What are the 10 most common words used in board game descriptions?

Q11. 
**Is there any relationship between average game time and ownership, min/max 
players?**

Q12. 
How does number of people who wish to own the game and who own the game plot 
against each other?  

Q13. 
How does Rank and average rating plot against each other. (Highly ranked games should have more rating)

Q14. 
Which age group prefers which type of game eg medical , building etc.? eg. 
younger children might be interested in building games etc and teenagers might be 
interested in games like Monopoly

Q15. 
Are people intrigued by a particular game designer?

Q16. 
**How did the era of electronic games(starting from 2010-11) affect the number of people who want/wish/own board games?** 

Q17. 
Is it right to assume that a game board publisher publishes a single type of 
board game and do the game publishers only focus on a certain age group?

Q18. 
Are people intrigued by a particular game publisher?

Q19. 
How accurate has bayes average been?

Q20. 
Which era or decade played a big role in people playing more board games?


## Interested Questions

Q1.
What are the common game mechanics and their changes in prevalent?

Q2.
What is the distribution of ratings for the board games?

Q3.
Is there any relationship between average playing time of a game and ownership(or products sold), min/max players required to play that game. 

Q4.
How did the era of electronic games(starting from 2010-11) affect the number of people who want/wish/own board games? 


# Expected findings

Q1.
The most common game mechanics maybe the 'Acting', 'Dice Rolling' and 'Hand Management'. I guess many game mechanics will become more popular.

Q2.
I guess the ratings for the games follow a normal distribution.

Q3.
More average play might mean less owners, as people might not want to invest too much time in a game, but it might be popular among bigger groups as board games keep a group engaged. But as the required number of players increase, the number of products sold should drop.

Q4.
The demand of board games should be lower after the start of electronic games 
era.


# Analysis and findings

## Q1. What are the common game mechanics and their changes in prevalent?

### Data Wrangling

```{r}
q1_ratings <- ratings %>%
  select(id, name)
q1_details <- details %>%
  select(id, yearpublished, boardgamemechanic)

Q1_data <- q1_ratings %>%
  inner_join(q1_details,
             by = "id")

Q1_data$boardgamemechanic <- gsub('[[]', '', Q1_data$boardgamemechanic)
Q1_data$boardgamemechanic <- gsub('[]]', '', Q1_data$boardgamemechanic)

Q1_data <- Q1_data %>%
  separate_rows(boardgamemechanic, sep = ",") %>%
  arrange(id)

Q1_data$boardgamemechanic <- gsub("'", '', Q1_data$boardgamemechanic)
Q1_data$boardgamemechanic <- str_trim(Q1_data$boardgamemechanic)
Q1_data$boardgamemechanic <- gsub('"', '', Q1_data$boardgamemechanic)
```


### Analysis

```{r, table1, }
Table1 = Q1_data %>%
  count(boardgamemechanic, sort = TRUE) %>%
  top_n(10)
knitr::kable(Table1, booktabs = TRUE, "html",
             caption = "The Most Common Game Mechanics") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "hold_position"), 
                full_width = F,
                font_size = 14)
```


```{r, figure1}
Q1_data %>%
  count(boardgamemechanic, sort = TRUE) %>%
  na.omit() %>%
  top_n(20) %>%
  ggplot(aes(x = reorder(boardgamemechanic, n),
             y = n)) +
  geom_col(fill = "#78a99c",
           color = "#3f6b61",
           show.legend = FALSE) +
  coord_flip() +
  scale_x_reordered() +
  labs(x = "Number",
       y = "Mechanics",
       title = "Most Common Mechanics") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5)) -> p1
ggplotly(p1)
```


```{r, figure2}
Q1_data %>%
  filter(yearpublished %in% c(1990:2002, 2010:2022)) %>%
  mutate(year = ifelse(yearpublished <= 2002, "1990s", "2010s")) %>%
  group_by(year, boardgamemechanic) %>%
  summarise(count = n()) %>%
  top_n(20) %>%
  spread(key = year, value = count) %>%
  na.omit() %>%
  ggplot() +
  geom_point(aes(x = `1990s`,
                 y = reorder(boardgamemechanic, `2010s` - `1990s`)), 
             color = "#Aa3428") +
  geom_point(aes(x = `2010s`,
                 y = boardgamemechanic), 
             color = "#609c6c",
             size = 3) +
  geom_segment(aes(x = `1990s`, 
                   xend = `2010s`,
                   y = boardgamemechanic, 
                   yend = boardgamemechanic)) +
  theme_minimal() +
  labs(x = "Number",
       y = "Mechanics", 
       title = "Most Prevalent Mechanics in the 1990s and 2010s") -> p2
ggplotly(p2)
```


## Q1 Conclusion

* According to above table and column plot, we can find that the most common game mechanic is **Dice Rolling**, unsurprisingly. This is because **Dice Rolling** itself is a mechanic that can be used in many games. It has been around for a long time, and ancient peoples could make simple dice out of stones, clay, bones, etc. to play the game, so **Dice Rolling** is often seen as the most dominant symbol of board games (Sofiia & Joseph Alexander, 2017).

* Before I analyzed this question, I made an inference based on the actual situation of family and friends in my life -- the most common board game mechanics will become more and more popular. With lollipop plot above, we can see that the top 20 most common game mechanics have become more and more popular over the past few decades. This is consistent with my previous assumptions. 

* This is because modern board games are starting to include more mechanics, and the variety of games is becoming richer over time, so board games as a whole can also appeal to a wider audience. Another very important reason is that we now have a better standard of living and more free time, and the increase in leisure time is an obvious driver of demand for entertainment products such as board games.


## Q2. What is the distribution of ratings for the board games?

### Data Wrangling

```{r}
q2_ratings <- ratings %>%
  select(id, name, average)
q2_details <- details %>%
  select(id,yearpublished)

Q2_data <- q2_ratings %>%
  inner_join(q2_details,
             by = "id")
```


### Analysis

```{r, figure3}
# plot
Q2_data %>%
  filter(yearpublished >= 1990) %>%
  ggplot(aes(x = average,
             y = ..density..)) +
  geom_histogram(fill = "#78a99c", 
                 color = "#3f6b61", 
                 alpha = 0.9) +
  geom_density(color = "#Aa3428") +
  labs(x = "Average Rating",
       y = "Density",
       title = "Distribution of Average Ratings") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5)) -> p3
ggplotly(p3)
```


```{r, table2}
# ks.test
ks.test <- ks.test(x = Q2_data$average, 'pnorm', 
                   mean = mean(Q2_data$average), 
                   sd = sd(Q2_data$average))
Table2 = tidy(ks.test)
knitr::kable(Table2, booktabs = TRUE, "html",
             caption = "Boardgame Ratings ks.test",
             digits = 10) %>%
  kable_styling(bootstrap_options = c("striped", "hover", "hold_position"), 
                full_width = F)
```


## Q2 Conclusion

* From the above table output we can see that the test statistic is 0.021989, corresponding to a p-value of 1.647e-09. Since the p-value is less than 0.05, we reject the original hypothesis. We have sufficient evidence that the board game ratings for this sample data are not from a normal distribution.


## Q3 Is there any relationship between average playing time of a game and ownership, min/max players required to play that game. 

### Data preparation

* Selecting variables needed for the analysis from both datasets and the joining(using inner_join) them to make the data tidy.

```{r}
q3_ratings <- ratings %>%
  select(id, name)

q3_details <- details %>%
  select(id, minplayers, maxplayers, playingtime, owned)

Q3_dataset <- q3_ratings %>%
  inner_join(q3_details,
             by = "id")  
```

### Analysis

* Plotting total number of owners of a game against their owned game average playing time, after filtering playing time less than 500 min to get the if there is any correlation.  

```{r plot-a, fig.cap = "Relationship between average game time and games owned"}

plot <- Q3_dataset %>%
  filter(playingtime <= 500)%>%
  na.omit() %>%
  ggplot(
       aes(x = playingtime,
           y = owned)) +
  geom_line(color = "#F6370F") +
  xlab("Average playing time of a game") +
  ylab("Number of people who own the game") +
  labs(title = "Number of people who own the game Vs Average playing time") +
  labs(colour = "Current status of people") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5),
        text = element_text(size = 10)) 

ggplotly(plot)
```

* Checking linear model co-efficients to confirm my observation.

```{r}
lm(owned ~ playingtime, Q3_dataset)
```

* Plotting for different number of minimum players for a game to see, if a game requires more number of people, it has more playing time which in turn means less sold products.  

```{r plot-b, fig.cap = "Relationship between average game time and games owned faceted for diiferent minimum players required"}

Q3_dataset %>%
  filter(playingtime <= 250) %>%
  na.omit() %>% 
  group_by(minplayers, playingtime) %>%
  summarise(sum = sum(owned)) %>% 
  ggplot(
       aes(x = playingtime,
           y = sum)) +
  geom_bar(stat = "identity",
           color = "#F6370F") +
  facet_wrap(~minplayers,
             scales = "free")+
  xlab("Average playing time of a game") +
  ylab("Number of people who own the game") +
  labs(title = "Number of players required to play a game for average playing time") +
  labs(colour = "Current status of people") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5),
        text = element_text(size = 10)) 

```


```{r tab}

t <- Q3_dataset %>%
  filter(playingtime <= 250) %>% 
  group_by(minplayers) %>%
  summarise(sum = sum(owned))

knitr::kable(t, caption = "Minimum number of people required to play a game Vs games sold in that age category") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "hold_position"), 
                full_width = T)
```


## Q3 Conclusion

* According to the plot in figure \@ref(fig:plot-a) one can clearly observe that if the average playing time of board games **increases**, the number of people who own that game **decreases**. My reason to assume the same was, games which require a lot of time to finish, might be a less popular option for people as a result of lack of time.

* To verify my result, I fitted a linear model for the variables and found out the slope was negative.

* A game with more playing time might sell less products but it can be the popular with people who play games in big groups. I expected, as the number of people required to play a game increases, the game's selling numbers should drop. See Figure \@ref(fig:plot-b), one can observe as the required players to play a game **increases**, the number of products sold decreased drastically (See also \@ref(tab:tab) ) as smaller groups of people can more often indulge in board games.


## Q4 How did the era of electronic games(starting from 2012-13) affect the number of people who want/wish/own board games? 

### Data preparation

* Selecting variables needed for the analysis from both datasets and the joining them to make the data tidy. Pivoting data to get a better perspective to understand data. 

```{r}

q4_ratings <- ratings %>%
  select(id, name)

q4_details <- details %>%
  select(id, yearpublished, trading, wanting, owned, wishing)

Q4_dataset <- q4_ratings %>%
  inner_join(q4_details,
             by = "id")  

Q4 <- Q4_dataset %>%
  pivot_longer(!c(id, name, yearpublished),
               names_to = "status",
               values_to = "number_of _people")

```

### Data Analysis

* Plotting graph to see if along the years board games sold, or number of people  wishing/wanting to own game have dropped or not.  

```{r, plot3}

plot1 <- Q4 %>%
  filter(yearpublished >= 1990) %>%
  group_by(status, yearpublished) %>%
  summarise(mum_of_people = sum(`number_of _people`)) %>%
  ggplot(aes(x = yearpublished,
             y = mum_of_people,
             colour = status)) +
    geom_line() +
  geom_vline(xintercept = 2013) +
  xlab("Gmaes published in the given year") +
  ylab("Number of people") +
  labs(title = "Games sold over the years") +
  labs(colour = "Current status of people") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5),
        text = element_text(size = 8))  

ggplotly(plot1)  
```

## Q4 Conclusion

* There is now almost no market for new casual board games, and even the classics sell only a fraction of their annual sales just a few years ago. the advent of apps had a much more profound effect, absolutely devastating sales of casual board games but paradoxically increasing interest in German-style games.

* Many popular  mobile games like Temple Run, Subway Surfer e.t.c were released around the year 2012-13 which led to the assumption that as games were more easily accessible more then than ever, the digital games era must have hurt the turnover of board game publishers.

* As one can observe the vertical line is at year 2013, after which there was a drastic drop in number of people who bought new board games or wish or want them.
The number people owning a game peaked around year 2014 and then decreased by almost **5 times.** 


# Conclusion

The top 20 most common game mechanics have become more and more popular over the past few decades. The most common game mechanic being **Dice Rolling**. This was achieved by doing some text analysis of the selected columns, taking the help of functions like **seperate_row, gsub.** Plotting histogram and performing **KS-test statistic** on ratings of board games, helped us came to a conclusion that the board games rating from this data set does not follow normal distribution. The average playing time of a board game and minimum number of players required to play a game is **inversely proportional** to the number of games sold. We took a look at the linear model coefficients to confirm our assumption and observation.  
Data pivoting enabled us to rearrange the columns and rows in a report so we can view data from different perspectives. The era of mobile games affected people's interest in board games negatively as after year 2012-13 the number of games owned/want/wish/trade dropped drastically.


# References

C. Sievert. Interactive Web-Based Data Visualization with R, plotly, and shiny. Chapman
  and Hall/CRC Florida, 2020.

H. Wickham. ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York, 2016.

Lüdecke et al., (2021). performance: An R Package for Assessment, Comparison and Testing
  of Statistical Models. Journal of Open Source Software, 6(60), 3139.
  https://doi.org/10.21105/joss.03139

Robinson D (2022). _drlib: Personal R package of David Robinson_. R package version 0.1.1.

Robinson D, Hayes A, Couch S (2022). _broom: Convert Statistical Objects into Tidy
  Tibbles_. R package version 1.0.0, <https://CRAN.R-project.org/package=broom>.

Wickham H, Averick M, Bryan J, Chang W, McGowan LD, François R, Grolemund G, Hayes A,
  Henry L, Hester J, Kuhn M, Pedersen TL, Miller E, Bache SM, Müller K, Ooms J, Robinson D,
  Seidel DP, Spinu V, Takahashi K, Vaughan D, Wilke C, Woo K, Yutani H (2019). “Welcome to
  the tidyverse.” _Journal of Open Source Software_, *4*(43), 1686. doi:10.21105/joss.01686
  <https://doi.org/10.21105/joss.01686>.
  
Wickham H, Girlich M (2022). _tidyr: Tidy Messy Data_. R package version 1.2.0,
  <https://CRAN.R-project.org/package=tidyr>.
  
Wickham H (2022). _stringr: Simple, Consistent Wrappers for Common String Operations_. R
  package version 1.4.1, <https://CRAN.R-project.org/package=stringr>.

Yermolaieva S, Brown JA (2017). Dice design deserves discourse. _Game & Puzzle Design_, 3(2), 64-70.

Yihui Xie (2022). knitr: A General-Purpose Package for Dynamic Report Generation in R. R
  package version 1.39.

Zhu H (2021). _kableExtra: Construct Complex Table with 'kable' and Pipe Syntax_. R
  package version 1.3.4, <https://CRAN.R-project.org/package=kableExtra>.

